{"ast":null,"code":"import { useInjectedRequest } from './utils/useRequest.js';\nimport { log_sdk, requestCreateEvent, SdkError } from '@puzzlehq/sdk-core';\nimport { useIsConnected } from '../provider/PuzzleWalletProvider.js';\nimport { useWalletStore } from '../store.js';\nimport { useEvent } from './useEvent.js';\nimport { useCallback, useEffect, useState } from 'react';\nimport { EventStatus } from '@puzzlehq/types';\nconst normalizeInputs = inputs => {\n  return inputs?.map(input => {\n    if (typeof input === 'string') {\n      return input;\n    }\n    return input.plaintext;\n  });\n};\nexport const useRequestCreateEvent = requestData => {\n  const {\n    isConnected\n  } = useIsConnected();\n  const [account] = useWalletStore(state => [state.account]);\n  const [settlementStatus, setSettlementStatus] = useState(undefined);\n  const inputs = normalizeInputs(requestData?.inputs);\n  const req = {\n    method: 'requestCreateEvent',\n    params: {\n      ...requestData,\n      inputs\n    }\n  };\n  const {\n    request,\n    data,\n    error: _error,\n    loading\n  } = useInjectedRequest(req, async req => {\n    if (!isConnected) throw new Error(SdkError.NotConnected);\n    const response = await requestCreateEvent(req.params);\n    return response;\n  });\n  const error = typeof _error === 'string' ? _error : _error instanceof Error ? _error.message : undefined;\n  const response = data;\n  const createEvent = useCallback(createEventRequestOverride => {\n    setSettlementStatus(undefined);\n    if (createEventRequestOverride && isConnected && !loading) {\n      const inputs = normalizeInputs(createEventRequestOverride.inputs);\n      const undefinedIndex = inputs?.findIndex(i => i === undefined);\n      if (undefinedIndex !== -1) {\n        throw new Error(`Input ${undefinedIndex} is undefined. Inputs: ${inputs}`);\n      }\n      const _request = {\n        method: 'requestCreateEvent',\n        params: {\n          ...createEventRequestOverride,\n          inputs\n        }\n      };\n      log_sdk('useCreateEvent requesting with override...', _request);\n      return request(_request);\n    } else if (requestData && isConnected && !loading) {\n      log_sdk('useCreateEvent requesting...', requestData);\n      const undefinedIndex = requestData.inputs?.findIndex(i => i === undefined);\n      if (undefinedIndex !== -1) {\n        throw new Error(`Input ${undefinedIndex} is undefined. Inputs: ${requestData.inputs}`);\n      }\n      return request();\n    }\n  }, [isConnected, JSON.stringify(account), loading, request, JSON.stringify(inputs)]);\n  const eventId = response?.eventId ?? requestData?.settlementInfo?.eventId;\n  const {\n    event,\n    error: eventFetchError\n  } = useEvent({\n    id: eventId ?? '',\n    address: requestData?.address\n  });\n  useEffect(() => {\n    console.log('eventId', eventId);\n  }, [eventId]);\n  useEffect(() => {\n    console.log('event', event);\n  }, [JSON.stringify(event)]);\n  useEffect(() => {\n    if (event?.status === EventStatus.Creating || loading) setSettlementStatus('Creating');else if (event?.status === EventStatus.Pending) setSettlementStatus('Pending');else if (event?.status === EventStatus.Failed || error) setSettlementStatus('Failed');else if (event?.status === EventStatus.Settled) {\n      if (requestData?.settlementInfo && requestData.settlementInfo.currentRecordCount === requestData.settlementInfo.expectedRecordCount) {\n        setSettlementStatus('SettledWithRecords');\n      } else {\n        setSettlementStatus('Settled');\n      }\n    }\n  }, [loading, JSON.stringify(event), JSON.stringify(eventFetchError), JSON.stringify(requestData?.settlementInfo), error]);\n  return {\n    createEvent,\n    eventId: response?.eventId,\n    loading,\n    error,\n    settlementStatus\n  };\n};","map":{"version":3,"names":["useInjectedRequest","log_sdk","requestCreateEvent","SdkError","useIsConnected","useWalletStore","useEvent","useCallback","useEffect","useState","EventStatus","normalizeInputs","inputs","map","input","plaintext","useRequestCreateEvent","requestData","isConnected","account","state","settlementStatus","setSettlementStatus","undefined","req","method","params","request","data","error","_error","loading","Error","NotConnected","response","message","createEvent","createEventRequestOverride","undefinedIndex","findIndex","i","_request","JSON","stringify","eventId","settlementInfo","event","eventFetchError","id","address","console","log","status","Creating","Pending","Failed","Settled","currentRecordCount","expectedRecordCount"],"sources":["/Users/erdemrencbereli/Desktop/erdemrenc_ethdenver_aleo/aleo_dapp/node_modules/@puzzlehq/sdk/dist/src/hooks/useRequestCreateEvent.js"],"sourcesContent":["import { useInjectedRequest } from './utils/useRequest.js';\nimport { log_sdk, requestCreateEvent, SdkError, } from '@puzzlehq/sdk-core';\nimport { useIsConnected } from '../provider/PuzzleWalletProvider.js';\nimport { useWalletStore } from '../store.js';\nimport { useEvent } from './useEvent.js';\nimport { useCallback, useEffect, useState } from 'react';\nimport { EventStatus } from '@puzzlehq/types';\nconst normalizeInputs = (inputs) => {\n    return inputs?.map((input) => {\n        if (typeof input === 'string') {\n            return input;\n        }\n        return input.plaintext;\n    });\n};\nexport const useRequestCreateEvent = (requestData) => {\n    const { isConnected } = useIsConnected();\n    const [account] = useWalletStore((state) => [state.account]);\n    const [settlementStatus, setSettlementStatus] = useState(undefined);\n    const inputs = normalizeInputs(requestData?.inputs);\n    const req = {\n        method: 'requestCreateEvent',\n        params: {\n            ...requestData,\n            inputs,\n        },\n    };\n    const { request, data, error: _error, loading, } = useInjectedRequest(req, async (req) => {\n        if (!isConnected)\n            throw new Error(SdkError.NotConnected);\n        const response = await requestCreateEvent(req.params);\n        return response;\n    });\n    const error = typeof _error === 'string' ? _error : _error instanceof Error ? _error.message : undefined;\n    const response = data;\n    const createEvent = useCallback((createEventRequestOverride) => {\n        setSettlementStatus(undefined);\n        if (createEventRequestOverride && isConnected && !loading) {\n            const inputs = normalizeInputs(createEventRequestOverride.inputs);\n            const undefinedIndex = inputs?.findIndex(i => i === undefined);\n            if (undefinedIndex !== -1) {\n                throw new Error(`Input ${undefinedIndex} is undefined. Inputs: ${inputs}`);\n            }\n            const _request = {\n                method: 'requestCreateEvent',\n                params: {\n                    ...createEventRequestOverride,\n                    inputs,\n                },\n            };\n            log_sdk('useCreateEvent requesting with override...', _request);\n            return request(_request);\n        }\n        else if (requestData && isConnected && !loading) {\n            log_sdk('useCreateEvent requesting...', requestData);\n            const undefinedIndex = requestData.inputs?.findIndex(i => i === undefined);\n            if (undefinedIndex !== -1) {\n                throw new Error(`Input ${undefinedIndex} is undefined. Inputs: ${requestData.inputs}`);\n            }\n            return request();\n        }\n    }, [isConnected, JSON.stringify(account), loading, request, JSON.stringify(inputs)]);\n    const eventId = response?.eventId ?? requestData?.settlementInfo?.eventId;\n    const { event, error: eventFetchError } = useEvent({\n        id: eventId ?? '',\n        address: requestData?.address,\n    });\n    useEffect(() => {\n        console.log('eventId', eventId);\n    }, [eventId]);\n    useEffect(() => {\n        console.log('event', event);\n    }, [JSON.stringify(event)]);\n    useEffect(() => {\n        if (event?.status === EventStatus.Creating || loading)\n            setSettlementStatus('Creating');\n        else if (event?.status === EventStatus.Pending)\n            setSettlementStatus('Pending');\n        else if (event?.status === EventStatus.Failed || error)\n            setSettlementStatus('Failed');\n        else if (event?.status === EventStatus.Settled) {\n            if (requestData?.settlementInfo &&\n                requestData.settlementInfo.currentRecordCount ===\n                    requestData.settlementInfo.expectedRecordCount) {\n                setSettlementStatus('SettledWithRecords');\n            }\n            else {\n                setSettlementStatus('Settled');\n            }\n        }\n    }, [\n        loading,\n        JSON.stringify(event),\n        JSON.stringify(eventFetchError),\n        JSON.stringify(requestData?.settlementInfo),\n        error,\n    ]);\n    return {\n        createEvent,\n        eventId: response?.eventId,\n        loading,\n        error,\n        settlementStatus,\n    };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}